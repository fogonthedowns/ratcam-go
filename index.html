<!DOCTYPE html>
<html>
<head>
	<title>webcam</title>
  <style>
    body {
      margin: 0px;
    }
  </style>
</head>
<body>
<img id="pic" /><br />
Frame rate: <span id="framerate"></span>
<script type="text/javascript">
	var picEle = document.getElementById("pic")
	var frameRateEle = document.getElementById("framerate")
	var frameRate = 0

	const socket = new WebSocket('ws://' + window.location.host + '/ws')

	socket.addEventListener('open', function (event) {
		console.log('websocket opened')
	})

	socket.addEventListener('message', function (event) {
		var reader = new FileReader()
		reader.readAsDataURL(event.data)
		reader.onloadend = function() {
			picEle.src = reader.result
			frameRate++
		}
	})

	setInterval(function() {
		frameRateEle.textContent = frameRate
		frameRate = 0
	}, 1000)
</script>
</body>
</html>
